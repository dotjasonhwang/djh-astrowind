---
/**
 * Admin page for Decap CMS (formerly Netlify CMS)
 * Provides a content management interface for non-technical users
 */

const metadata = {
  title: 'Admin Panel - Content Management',
  description: 'Content management system for website administration',
  robots: {
    index: false,
    follow: false,
  },
};
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{metadata.title}</title>
    <meta name="description" content={metadata.description} />
    <meta name="robots" content="noindex,nofollow" />

    <!-- Prevent the page from being indexed -->
    <meta name="robots" content="noindex, nofollow" />
    <meta name="googlebot" content="noindex, nofollow" />

    <!-- Decap CMS Styles -->
    <link rel="stylesheet" href="/admin/decap-preview-styles.css" />

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  </head>
  <body>
    <!-- Decap CMS Admin Interface -->
    <div id="nc-root"></div>

    <!-- Loading Indicator -->
    <div
      id="cms-loading"
      style="
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #f8f9fa;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      z-index: 9999;
    "
    >
      <div
        style="
        width: 40px;
        height: 40px;
        border: 4px solid #e9ecef;
        border-top: 4px solid #007bff;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
      "
      >
      </div>
      <p style="color: #6c757d; margin: 0; font-size: 16px;">Loading Content Management System...</p>
    </div>

    <style>
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Hide loading indicator once CMS loads */
      .cms-loaded #cms-loading {
        display: none;
      }

      /* Ensure CMS takes full height */
      html,
      body {
        height: 100%;
        margin: 0;
        padding: 0;
      }

      #nc-root {
        height: 100vh;
      }
    </style>

    <!-- Decap CMS Script -->
    <script type="module">
      // Import Decap CMS
      import('https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js')
        .then(() => {
          // Hide loading indicator
          document.body.classList.add('cms-loaded');

          // Initialize CMS
          if (window.CMS) {
            // Custom preview styles
            window.CMS.registerPreviewStyle('/admin/decap-preview-styles.css');

            // Custom preview templates can be registered here
            // Example: window.CMS.registerPreviewTemplate('blog', BlogPreview);

            console.log('‚úÖ Decap CMS loaded successfully');
          }
        })
        .catch((error) => {
          console.error('‚ùå Failed to load Decap CMS:', error);
          document.getElementById('cms-loading').innerHTML = `
          <div style="text-align: center; color: #dc3545;">
            <h2>Failed to Load CMS</h2>
            <p>There was an error loading the content management system.</p>
            <p style="font-size: 14px; color: #6c757d;">Please check your internet connection and try again.</p>
            <button onclick="window.location.reload()" style="
              background: #007bff;
              color: white;
              border: none;
              padding: 10px 20px;
              border-radius: 4px;
              cursor: pointer;
              margin-top: 10px;
            ">Retry</button>
          </div>
        `;
        });
    </script>

    <!-- Development mode indicator -->
    <script>
      if (import.meta.env.DEV) {
        console.log('üîß CMS Admin Panel - Development Mode');
        console.log('üìÅ Config file: /public/admin/config.yml');
        console.log('üé® Preview styles: /public/admin/decap-preview-styles.css');
      }
    </script>
  </body>
</html>
